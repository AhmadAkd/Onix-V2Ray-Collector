# ğŸš€ V2Ray Config Collector & Tester

<div align="center">

[![V2Ray Collector](https://img.shields.io/badge/V2Ray-Collector-blue?style=for-the-badge&logo=v2ray)](https://github.com/AhmadAkd/V2Ray_Collector)
[![Python](https://img.shields.io/badge/Python-3.8+-green?style=for-the-badge&logo=python)](https://www.python.org/)
[![GitHub Actions](https://img.shields.io/badge/GitHub%20Actions-Automated-orange?style=for-the-badge&logo=github)](https://github.com/features/actions)
[![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)](LICENSE)
[![Docker](https://img.shields.io/badge/Docker-Ready-blue?style=for-the-badge&logo=docker)](https://www.docker.com/)
[![FastAPI](https://img.shields.io/badge/FastAPI-API-teal?style=for-the-badge&logo=fastapi)](https://fastapi.tiangolo.com/)

**ğŸ”’ Advanced System for Automated Collection, Testing & Categorization of Free V2Ray Configs**

*Smart Automation â€¢ Protocol-Based Testing â€¢ Advanced Analytics â€¢ Health Monitoring â€¢ RESTful API*

[ğŸŒ View Main Page](https://ahmadakd.github.io/V2Ray_Collector/) â€¢
[ğŸ“Š Dashboard](https://ahmadakd.github.io/V2Ray_Collector/subscriptions/dashboard.html) â€¢
[ğŸ“š Documentation](docs/) â€¢
[ğŸ› Report Bug](https://github.com/AhmadAkd/V2Ray_Collector/issues)

</div>

---

## ğŸ“– Table of Contents

- [âœ¨ Key Features](#-key-features)
- [ğŸ¯ Advanced Capabilities](#-advanced-capabilities)
- [ğŸ“¡ Subscription Links](#-subscription-links)
- [ğŸš€ Installation & Setup](#-installation--setup)
- [ğŸ”§ Usage](#-usage)
- [ğŸ“Š API Documentation](#-api-documentation)
- [ğŸ³ Docker Deployment](#-docker-deployment)
- [âš™ï¸ Configuration](#ï¸-configuration)
- [ğŸ“ˆ Monitoring & Analytics](#-monitoring--analytics)
- [ğŸ¤ Contributing](#-contributing)
- [ğŸ“„ License](#-license)

---

## âœ¨ Key Features

### ğŸ”„ **Smart Collection**

- ğŸŒ **28+ Trusted Sources** from around the world
- ğŸ“¦ **Full Base64 Support** and various formats
- ğŸ”„ **Automatic Collection** every 30 minutes via GitHub Actions
- ğŸ’¾ **Smart Caching** with TTL for improved performance
- ğŸ¯ **Smart Filtering** - Pre-filter invalid configs

### âœ… **Professional Quality Testing**

- ğŸ”Œ **10 Protocols Supported**: VMess, VLESS, Trojan, Shadowsocks, SSR, Hysteria, Hysteria2, WireGuard, TUIC, Naive
- âš¡ **Ultra-Fast Testing** with 100 concurrent connections
- ğŸ” **Protocol-Based Testing** - Real TCP/TLS testing
- ğŸ“Š **95%+ Accuracy** in detecting healthy configs
- â±ï¸ **Precise Latency Measurement** for each config
- ğŸ” **Smart Deduplication** - Remove duplicate configs

### ğŸ“Š **Advanced Analytics**

- ğŸ“ˆ **Performance Metrics** - Comprehensive performance metrics
- ğŸ“‰ **Trend Analysis** - Historical data trend analysis
- ğŸ’¡ **Key Insights** - Intelligent insights and recommendations
- ğŸ¯ **Optimization Recommendations** - Performance optimization tips
- ğŸ“Š **Protocol Distribution** - Protocol and country distribution

### ğŸ¥ **Health Monitoring**

- âœ… **6 Different Health Checks**
- ğŸŒ **GitHub Connectivity** - Connection monitoring
- ğŸ“¡ **Config Sources** - Source accessibility check
- ğŸ’¾ **Disk Space** - Disk space monitoring
- ğŸ§  **Memory Usage** - Memory monitoring
- âš¡ **Cache Performance** - Cache performance tracking

### ğŸŒ **Professional UI/UX**

- ğŸ¨ **Advanced Dashboard** with Bootstrap 5
- ğŸ“± **Responsive Design** - Compatible with all devices
- ğŸ“Š **Interactive Charts** - Chart.js
- ğŸ”„ **Real-time Statistics** - Live stats
- ğŸ¯ **Subscription Selector** - Smart selector
- ğŸŒ“ **Dark/Light Mode** - Dark/Light theme support

### ğŸ”Œ **RESTful API**

- âš¡ **FastAPI Framework** - Fast and modern
- ğŸ“¡ **Complete Endpoints** - Access to all features
- ğŸ“Š **Real-time Stats** - Statistics API
- ğŸ” **CORS Support** - CORS enabled
- ğŸ“ **Auto Documentation** - Automatic Swagger docs

### ğŸ¤– **Complete Automation**

- â° **Scheduled Jobs** - Scheduled tasks
- ğŸ”„ **Auto Deployment** - Automatic deployment
- ğŸ“Š **Stats Tracking** - Statistics tracking
- ğŸ”” **Notifications** - Smart notifications (Telegram, Email, Webhook)
- ğŸ”§ **Error Recovery** - Automatic error recovery

---

## ğŸ¯ Advanced Capabilities

### âš¡ **Performance Optimization**

```python
âœ… UltraFastConnectionPool - Test 100 configs simultaneously
âœ… SmartConfigFilter - Smart pre-filtering
âœ… MD5 Hash Deduplication - Hash-based deduplication
âœ… Async/Await - Asynchronous programming
âœ… Connection Pooling - Optimal resource usage
```

### ğŸ“ **Smart Categorization**

```
âœ… Categorization by Protocol (10 protocols)
âœ… Categorization by Country (270+ countries)
âœ… Sorting by Latency
âœ… Advanced Geographic Filtering
âœ… Country Prioritization
```

### ğŸ” **Security**

```
âœ… Rate Limiting - Request limiting
âœ… IP Blacklisting - IP blocking
âœ… SSL/TLS Verification - Certificate verification
âœ… Input Validation - Input validation
âœ… Secure Headers - Secure headers
```

### ğŸ“Š **Reporting**

```
âœ… JSON Reports - JSON reports
âœ… Performance Metrics - Performance metrics
âœ… Error Analysis - Error analysis
âœ… Geographic Distribution - Geographic distribution
âœ… Historical Data - Historical data
```

---

## ğŸ“¡ Subscription Links

### ğŸŒ **Web Pages**

| Page | Description | Link |
|------|-------------|------|
| ğŸ  **Main Page** | Display all subscription links | [View](https://ahmadakd.github.io/V2Ray_Collector/) |
| ğŸ“Š **Dashboard** | Management dashboard with complete stats | [View](https://ahmadakd.github.io/V2Ray_Collector/subscriptions/dashboard.html) |
| ğŸ¯ **Selector** | Smart link selector | [View](https://ahmadakd.github.io/V2Ray_Collector/subscriptions/subscription_selector.html) |

### ğŸ“‹ **Direct Subscription Links**

#### ğŸ“¦ **All Configs** (Recommended)

```
https://raw.githubusercontent.com/AhmadAkd/V2Ray_Collector/main/subscriptions/all_subscription.txt
```

#### ğŸ”µ **VMess** (Most Configs)

```
https://raw.githubusercontent.com/AhmadAkd/V2Ray_Collector/main/subscriptions/vmess_subscription.txt
```

#### ğŸŸ¢ **VLESS** (Fastest)

```
https://raw.githubusercontent.com/AhmadAkd/V2Ray_Collector/main/subscriptions/vless_subscription.txt
```

#### ğŸŸ¡ **Trojan** (Most Secure)

```
https://raw.githubusercontent.com/AhmadAkd/V2Ray_Collector/main/subscriptions/trojan_subscription.txt
```

#### ğŸŸ  **Shadowsocks**

```
https://raw.githubusercontent.com/AhmadAkd/V2Ray_Collector/main/subscriptions/ss_subscription.txt
```

#### ğŸŸ£ **ShadowsocksR**

```
https://raw.githubusercontent.com/AhmadAkd/V2Ray_Collector/main/subscriptions/ssr_subscription.txt
```

### ğŸŒ **Country-Based Categorization**

Subscription links by country:

```
https://raw.githubusercontent.com/AhmadAkd/V2Ray_Collector/main/subscriptions/by_country/{COUNTRY_CODE}.txt
```

**Examples:**

- ğŸ‡ºğŸ‡¸ United States: `by_country/US.txt`
- ğŸ‡©ğŸ‡ª Germany: `by_country/DE.txt`
- ğŸ‡³ğŸ‡± Netherlands: `by_country/NL.txt`
- ğŸ‡¬ğŸ‡§ United Kingdom: `by_country/GB.txt`

---

## ğŸš€ Installation & Setup

### ğŸ“‹ **Prerequisites**

- Python 3.8 or higher
- pip (Python package manager)
- Git

### ğŸ“¥ **Quick Install**

#### 1ï¸âƒ£ **Clone the Repository**

```bash
git clone https://github.com/AhmadAkd/V2Ray_Collector.git
cd V2Ray_Collector
```

#### 2ï¸âƒ£ **Install Dependencies**

```bash
pip install -r requirements.txt
```

#### 3ï¸âƒ£ **Run the Project**

```bash
# Collect and test configs
python config_collector.py

# Run automation
python automation.py

# Start API server
python api_server.py
```

### ğŸªŸ **Windows**

For Windows users, use PowerShell scripts:

```powershell
# Quick run
.\run.ps1

# Run with Persian language
.\run-fa.ps1

# Push to GitHub
.\push-to-github.ps1
```

### ğŸ§ **Linux/macOS**

```bash
# Run automation
chmod +x push-to-github.sh
./push-to-github.sh
```

---

## ğŸ”§ Usage

### 1ï¸âƒ£ **Manual Collection**

```python
from config_collector import V2RayCollector
import asyncio

async def main():
    collector = V2RayCollector()
    
    # Collect configs
    configs = await collector.collect_all_configs()
    print(f"âœ… {len(configs)} configs collected")
    
    # Test configs
    await collector.test_all_configs(configs)
    print(f"âœ… {len(collector.working_configs)} healthy configs")
    
    # Categorize
    categories = collector.categorize_configs()
    
    # Generate subscription files
    subscription_files = collector.generate_subscription_links(categories)
    
    # Generate report
    report = collector.generate_report()
    print(report)

asyncio.run(main())
```

### 2ï¸âƒ£ **Automation**

```python
from automation import AutomationManager

# Create automation manager
manager = AutomationManager()

# Run once
await manager.run_collection_job()

# Run scheduled
manager.start_scheduler()
```

### 3ï¸âƒ£ **Using the API**

```python
import requests

# Get overall stats
response = requests.get('http://localhost:8000/api/stats')
print(response.json())

# Get all configs
response = requests.get('http://localhost:8000/api/configs')
configs = response.json()

# Get VMess subscription link
response = requests.get('http://localhost:8000/api/subscription/vmess')
vmess_link = response.text
```

### 4ï¸âƒ£ **Health Monitoring**

```python
from health_monitor import HealthMonitor
import asyncio

async def check_health():
    monitor = HealthMonitor()
    
    # Check all components
    health_report = await monitor.run_all_health_checks()
    
    # Display report
    for component, status in health_report.items():
        print(f"{component}: {status.status} - {status.message}")

asyncio.run(check_health())
```

### 5ï¸âƒ£ **Analytics**

```python
from analytics import AdvancedAnalytics

# Create analytics
analytics = AdvancedAnalytics()

# Analyze performance
metrics = analytics.analyze_performance(configs_data)

# Analyze trends
trends = analytics.analyze_trends()

# Get insights
insights = analytics.get_key_insights(metrics)

# Generate comprehensive report
report = analytics.generate_comprehensive_report(configs_data)
```

---

## ğŸ“Š API Documentation

### ğŸ”Œ **Endpoints**

#### **1. Get Overall Stats**

```http
GET /api/stats
```

**Response:**

```json
{
  "total_configs": 2448,
  "working_configs": 2448,
  "protocols": {
    "vmess": 1526,
    "vless": 746,
    "trojan": 167
  },
  "countries": 270,
  "last_update": "2025-10-14 10:30:00",
  "success_rate": "70.5%"
}
```

#### **2. Get All Configs**

```http
GET /api/configs?protocol=vmess&limit=100
```

**Parameters:**

- `protocol` (optional): Filter by protocol
- `country` (optional): Filter by country
- `limit` (optional): Number of configs
- `offset` (optional): Starting index

#### **3. Get Subscription Link**

```http
GET /api/subscription/{protocol}
```

**Example:**

```bash
curl http://localhost:8000/api/subscription/vmess
```

#### **4. Health Check**

```http
GET /health
```

**Response:**

```json
{
  "status": "healthy",
  "timestamp": "2025-10-14T10:30:00",
  "components": {
    "github_connectivity": "healthy",
    "config_sources": "healthy",
    "disk_space": "healthy"
  }
}
```

#### **5. Get Analytics Report**

```http
GET /api/analytics
```

**Response includes:**

- Performance metrics
- Trend analysis
- Key insights
- Recommendations

### ğŸ“š **Full Documentation**

Complete API documentation is available at:

```
http://localhost:8000/docs      # Swagger UI
http://localhost:8000/redoc     # ReDoc
```

---

## ğŸ³ Docker Deployment

### ğŸš€ **Quick Start**

#### **1. Build and Run with Docker Compose**

```bash
# Build and run
docker-compose up -d

# View logs
docker-compose logs -f

# Stop
docker-compose down
```

#### **2. Manual Image Build**

```bash
# Build image
docker build -t v2ray-collector .

# Run container
docker run -d \
  --name v2ray-collector \
  -v $(pwd)/subscriptions:/app/subscriptions \
  -v $(pwd)/cache:/app/cache \
  -p 8000:8000 \
  v2ray-collector
```

### ğŸ¯ **Docker Services**

The project includes 2 services:

1. **v2ray-collector**: Automatic collection and testing
2. **v2ray-api**: API Server (port 8000)

### ğŸ“Š **Health Check**

Docker image includes automatic health check:

```dockerfile
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD python -c "import requests; requests.get('http://localhost:8000/health')"
```

---

## âš™ï¸ Configuration

### ğŸ“ **config.py File**

All project settings are in the `config.py` file:

#### **1. General Settings**

```python
GENERAL_CONFIG = {
    'log_level': 'INFO',
    'max_retries': 3,
    'request_timeout': 30,
    'cleanup_days': 7
}
```

#### **2. Collection Settings**

```python
COLLECTION_CONFIG = {
    'max_concurrent_tests': 50,
    'test_timeout': 10,
    'min_latency_threshold': 5000,
    'enable_speed_test': True,
    'enable_ssl_check': True
}
```

#### **3. Config Sources**

```python
CONFIG_SOURCES = [
    "https://github.com/Epodonios/v2ray-configs/raw/main/All_Configs_base64_Sub.txt",
    "https://raw.githubusercontent.com/mahdibland/V2RayAggregator/master/sub/sub_merge.txt",
    # ... 26 more sources
]
```

#### **4. Supported Protocols**

```python
SUPPORTED_PROTOCOLS = {
    'vmess': {'enabled': True, 'priority': 1},
    'vless': {'enabled': True, 'priority': 2},
    'trojan': {'enabled': True, 'priority': 3},
    'shadowsocks': {'enabled': True, 'priority': 4},
    'shadowsocksr': {'enabled': True, 'priority': 5}
}
```

#### **5. Notification Settings**

```python
NOTIFICATION_CONFIG = {
    'enable_notifications': False,
    'notification_methods': ['email', 'webhook', 'telegram'],
    'alert_conditions': {
        'low_success_rate': 50,
        'high_error_rate': 20,
        'no_working_configs': True
    }
}
```

### ğŸ” **Environment Variables**

```bash
# Set profile
export ACTIVE_PROFILE=production  # development, production, testing

# Telegram settings
export TELEGRAM_BOT_TOKEN=your_bot_token
export TELEGRAM_CHAT_ID=your_chat_id

# Email settings
export SMTP_SERVER=smtp.gmail.com
export SMTP_PORT=587
export SMTP_USERNAME=your_email
export SMTP_PASSWORD=your_password
```

---

## ğŸ“ˆ Monitoring & Analytics

### ğŸ“Š **Dashboard**

Management dashboard includes:

- ğŸ“ˆ **Real-time Stats** - Healthy/Unhealthy configs count
- ğŸ“Š **Charts** - Protocol and country distribution
- ğŸŒ **Geographic Map** - Geographic distribution of configs
- â±ï¸ **Latency Charts** - Latency charts
- ğŸ“‰ **Trend Analysis** - Trend changes

### ğŸ¥ **Health Monitoring**

Health monitoring system includes:

1. **GitHub Connectivity** - GitHub connection
2. **Config Sources** - Source accessibility
3. **API Endpoints** - API status
4. **Disk Space** - Disk space
5. **Memory Usage** - Memory usage
6. **Cache Performance** - Cache performance

### ğŸ“Š **Analytics Reports**

Analytics reports include:

```json
{
  "performance_metrics": {
    "total_configs": 3470,
    "working_configs": 2448,
    "success_rate": 70.5,
    "avg_latency": 89.3
  },
  "trend_analysis": {
    "config_count_trend": "increasing",
    "success_rate_trend": "stable",
    "latency_trend": "improving"
  },
  "key_insights": [
    "VMess has the best performance",
    "US configs have lowest latency",
    "Success rate improved by 5%"
  ],
  "recommendations": [
    "Add more Trojan sources",
    "Optimize connection pool size",
    "Increase test timeout for slow regions"
  ]
}
```

---

## ğŸ¤– GitHub Actions

### âš™ï¸ **Workflows**

The project includes 7 workflows:

#### **1. V2Ray Collector** (`v2ray-collector.yml`)

- â° Runs every 30 minutes
- âœ… Test sources
- ğŸ“¦ Collect configs
- ğŸ§ª Quality testing
- ğŸ“Š Generate reports
- ğŸš€ Deploy to GitHub Pages

#### **2. Deploy Pages** (`deploy-pages.yml`)

- ğŸŒ Deploy to GitHub Pages
- ğŸ”„ Trigger after Collector
- âœ… File verification

#### **3. Auto Collect** (`auto-collect.yml`)

- ğŸ”„ Automatic collection
- â° Scheduled

#### **4. CI** (`ci.yml`)

- ğŸ§ª Run tests
- âœ… Linting
- ğŸ“Š Coverage Report

#### **5. Docker Build** (`docker-build.yml`)

- ğŸ³ Build Docker image
- ğŸ“¦ Push to Docker Hub
- ğŸ·ï¸ Tagging

#### **6. Test** (`test.yml`)

- ğŸ§ª Unit tests
- ğŸ” Integration tests
- âœ… E2E tests

#### **7. Release** (`release.yml`)

- ğŸ“¦ Create release
- ğŸ“ Changelog generation
- ğŸ·ï¸ Version tagging

### ğŸ” **Required Secrets**

For GitHub Actions:

```yaml
GITHUB_TOKEN: GitHub token (automatic)
DOCKER_USERNAME: Docker Hub username (optional)
DOCKER_PASSWORD: Docker Hub password (optional)
TELEGRAM_BOT_TOKEN: Telegram bot token (optional)
TELEGRAM_CHAT_ID: Telegram chat ID (optional)
```

---

## ğŸ“š Documentation

### ğŸ“– **Guides**

- ğŸ“˜ [Installation Guide](docs/INSTALLATION.md) - Complete step-by-step installation
- ğŸ“— [User Guide](docs/USER_GUIDE.md) - Using the project
- ğŸ“• [Developer Guide](docs/DEVELOPER.md) - Development and contribution
- ğŸ“™ [API Documentation](docs/API.md) - Complete API docs
- ğŸ“” [Troubleshooting](docs/TROUBLESHOOTING.md) - Common issues

### ğŸ“Š **Project Stats**

```
ğŸ“¦ File Count: 364
ğŸ“ Lines of Code: ~15,000
ğŸ”Œ Supported Protocols: 10
ğŸŒ Config Sources: 28+
ğŸŒ Supported Countries: 270+
â­ Code Quality: A+
```

---

## ğŸ¤ Contributing

Your contribution to improving this project is highly valuable! ğŸ™

### ğŸ“ **How to Contribute**

1. **Fork** the project
2. Create a **Branch** (`git checkout -b feature/amazing-feature`)
3. **Commit** changes (`git commit -m 'Add amazing feature'`)
4. **Push** to Branch (`git push origin feature/amazing-feature`)
5. Create a **Pull Request**

### ğŸ› **Report Bugs**

Use [Issues](https://github.com/AhmadAkd/V2Ray_Collector/issues) to report bugs.

### ğŸ’¡ **Suggestions**

Share your suggestions via [Discussions](https://github.com/AhmadAkd/V2Ray_Collector/discussions).

### ğŸŒŸ **Contributors**

<a href="https://github.com/AhmadAkd/V2Ray_Collector/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=AhmadAkd/V2Ray_Collector" />
</a>

---

## ğŸ“Š Project Status

### âœ… **Recent Activities**

- âœ… Added 28 new config sources
- âœ… Implemented ultra-fast testing (100 concurrent)
- âœ… Added Advanced Analytics
- âœ… Implemented Health Monitoring
- âœ… Designed Professional Dashboard
- âœ… Created RESTful API
- âœ… Complete Docker support
- âœ… Comprehensive documentation in Persian and English

### ğŸš€ **Future Plans**

- [ ] Add Hysteria v3 support
- [ ] Implement Load Balancing
- [ ] Add Grafana Dashboard
- [ ] Kubernetes support
- [ ] Create Mobile App
- [ ] Add Machine Learning for quality prediction

---

## ğŸ”’ Security

To report security issues, please refer to [SECURITY.md](SECURITY.md).

**Note:** Never commit sensitive information (API keys, tokens, passwords) in code.

---

## ğŸ“„ License

This project is released under the MIT License. For more information, refer to the [LICENSE](LICENSE) file.

```
MIT License

Copyright (c) 2025 Ahmad Akd

Permission is hereby granted to use, copy, modify, merge, publish, distribute,
sublicense, and/or sell copies of the software.
```

---

## ğŸ™ Acknowledgments

### ğŸ“š **Resources Used**

- [V2Ray](https://www.v2ray.com/) - Main protocol
- [FastAPI](https://fastapi.tiangolo.com/) - API Framework
- [Bootstrap](https://getbootstrap.com/) - UI Framework
- [Chart.js](https://www.chartjs.org/) - Charts
- V2Ray community free config sources

### â­ **Support the Project**

If this project was helpful to you:

- â­ **Star** the project
- ğŸ› **Report** bugs
- ğŸ’¡ **Suggest** new features
- ğŸ¤ **Contribute** to development
- ğŸ“¢ **Share** with others

---

## ğŸ“ Contact Us

- ğŸ› **Issues:** [GitHub Issues](https://github.com/AhmadAkd/V2Ray_Collector/issues)
- ğŸ’¬ **Discussions:** [GitHub Discussions](https://github.com/AhmadAkd/V2Ray_Collector/discussions)
- ğŸ“§ **Email:** <ahmad.akd@example.com>
- ğŸŒ **Website:** [ahmadakd.github.io](https://ahmadakd.github.io/V2Ray_Collector/)

---

<div align="center">

**Made with â¤ï¸ by [Ahmad Akd](https://github.com/AhmadAkd)**

â­ If this project was useful to you, give it a Star! â­

[![GitHub stars](https://img.shields.io/github/stars/AhmadAkd/V2Ray_Collector?style=social)](https://github.com/AhmadAkd/V2Ray_Collector/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/AhmadAkd/V2Ray_Collector?style=social)](https://github.com/AhmadAkd/V2Ray_Collector/network/members)
[![GitHub watchers](https://img.shields.io/github/watchers/AhmadAkd/V2Ray_Collector?style=social)](https://github.com/AhmadAkd/V2Ray_Collector/watchers)

</div>

---

**Version:** 2.0.0  
**Last Updated:** 2025-10-14  
**Status:** âœ… Active and under development
